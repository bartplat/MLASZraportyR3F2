---
title: |
  | Raport z internetowego badania uczniów ostatnich klas w roku szkolnym 2020/2021
subtitle: |
  | `r get(params$obiektWskazniki)$dane_szk[[1]]$nazwa`
  | `r get(params$obiektWskazniki)$dane_szk[[1]]$adres`
output:
  pdf_document:
    dev: cairo_pdf
    fig_caption: no
    includes:
      in_header: naglowek2.tex
    toc: yes
    toc_depth: 2
lang: pl
papersize: a4
fontsize: 11pt
geometry: margin=20mm
params:
  plikZObiektami: ../../data/wsk_szkola_r3f2.RData
  obiektWskazniki: szk
  obiektWskaznikiPorownanie: woj
  progLiczebnosci: 10
  typDokumentu: pdf
  wyrownanieTabWykr: center
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)
library(kableExtra)
library(tidyr)

# library(MLASZraportyR3F2)
# if (!exists("params")) {
#   params = list(plikZObiektami = "~/01_IBE/07_Biezace_2022/16_wskazniki_cawi_r3f2/data/wskazniki/wsk_minimal_beta.RData",
#                 obiektWskazniki = "szk",
#                 obiektWskaznikiPorownanie = "woj",
#                 progLiczebnosci = 10,
#                 typDokumentu = "pdf",
#                 wyrownanieTabWykr = "center")
# }

progLiczebnosci = params$progLiczebnosci
typDokumentu = params$typDokumentu
wyrownanieTabWykr = params$wyrownanieTabWykr

if (params$plikZObiektami != "") {# to działa przy ręcznym prototypowaniu
  load(params$plikZObiektami)
  szk = get(params$obiektWskazniki)
  woj = get(params$obiektWskaznikiPorownanie)
} else {# to działa przy wywoływaniu przez generuj_raport()
  szk = get(params$obiektWskazniki)
  woj = get(params$obiektWskaznikiPorownanie)
}

woj = woj %>%
  filter(ID_RSPO %in% szk$ID_RSPO)
```

```{r functions, echo=FALSE, message=FALSE, warning=FALSE}
wyk_num = function() {
  nr = get0("___nrWykresu___", parent.frame(), ifnotfound = 1)
  assign("___nrWykresu___", nr + 1, envir = parent.frame())
  return(nr)
}
tab_num = function() {
  nr = get0("___nrTabeli___", parent.frame(), ifnotfound = 1)
  assign("___nrTabeli___", nr + 1, envir = parent.frame())
  return(nr)
}
# https://stackoverflow.com/questions/2631780/r-ggplot2-can-i-set-the-plot-title-to-wrap-around-and-shrink-the-text-to-fit-t
wrapper = function(x, ...) {
  paste(strwrap(x, ...), collapse = "\n")
}
```

`r ifelse(typDokumentu %in% "pdf", "---", "")`

`r ifelse(typDokumentu %in% "pdf", "\\vfill\n\\includegraphics{Belka-Losy-absolwentow-Kolor-PL}", "")`

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

# 1. Wprowadzenie

Szanowni Państwo, 

przekazujemy kolejny raport z badania ankietowego przeprowadzonego w ramach projektu monitorowania losów absolwentów szkół prowadzących kształcenie w zawodach szkolnictwa branżowego. `r ifelse(szk$l_abs[[1]] >= progLiczebnosci, paste0("Mamy nadzieję, że przedstawione wyniki okażą się dla Państwa ciekawe i pomocne w pracy."), paste0(""))`

1. Informacje o badaniu

    a) Badanie przeprowadzono w ramach projektu konkursowego "Monitorowanie Losów Absolwentów Szkół Zawodowych - II i III runda", realizowanego przez firmy PBS sp. z o.o. i Danae sp. z o.o. Prace związane z przygotowaniem narzędzi badawczych i opracowaniem wyników wykonano w Instytucie Badań Edukacyjnych korzystając ze wsparcia projektu systemowego "Monitorowanie Losów Absolwentów Szkół Zawodowych - etap II". Oba projekty są współfinansowane z funduszy Unii Europejskiej. Wsparcie pochodzi z Działania 2.15. "Kształcenie i szkolenie zawodowe dostosowane do potrzeb zmieniającej się gospodarki" II osi priorytetowej pn.: "Efektywna polityka publiczna dla rynku pracy, gospodarki i edukacji" z Programu Operacyjnego Wiedza, Edukacja, Rozwój (PO WER).
    b) Raport opiera się na wynikach badania internetowego przeprowadzonego w okresie od listopada 2021 roku do lutego 2022 roku. Badanie wśród absolwentów Państwa `r case_when(szk$TYP_SZK[[1]] %in% 1 ~ "szkoły branżowej pierwszego stopnia", szk$TYP_SZK[[1]] %in% 2 ~ "technikum", szk$TYP_SZK[[1]] %in% 3 ~ "szkoły policealnej")` realizowała firma `r szk$firma[[1]]`.
    c) Zaproszenie do wypełnienia ankiety on-line skierowano do `r szk$l_ucz_f1[[1]]` absolwentów, którzy w roku 2020/2021 wzięli udział w badaniu jako uczniowie ostatniej klasy Państwa szkoły. To samo badanie zrealizowano wówczas we wszystkich szkołach kształcących w zawodach szkolnictwa branżowego, o ile ich dyrektorzy wyrazili chęć udziału w badaniu.
        
        Raport z tego badania udostępniliśmy Państwu w styczniu 2022 roku, wysyłając link z adresu raporty@losyabsolwentow.pl.
    d) Ankietę wypełniło `r szk$l_abs[[1]]` absolwentów Państwa szkoły, tj. `r round(szk$l_abs[[1]] / szk$l_ucz_f1[[1]] * 100)`% uczniów, którzy wzięli udział w I fali badania. **Wyników nie należy uogólniać na pozostałych absolwentów Państwa szkoły.**

2) Prezentacja wyników

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$l_abs >= progLiczebnosci) {
  cat(
    "    a) Wyniki prezentowane w niniejszym raporcie, dotyczące absolwentów Państwa szkoły, zestawiono z odpowiedziami absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    " z tego samego rocznika. Pozwala to umieścić wyniki uzyskane w Państwa szkole w szerszym kontekście. Niemniej, biorąc pod uwagę specyfikę poszczególnych szkół oraz zróżnicowany poziom realizacji badania (wzięła w nim udział tylko część absolwentów poproszonych o wypełnienie ankiety), do zaobserwowanych różnic należy podchodzić z dużą ostrożnością.\n",
    "    b) Minimalna liczebność grupy respondentów, dla której przedstawiane są poszczególne wyniki w raporcie, wynosi 10 osób. Jeżeli wśród absolwentów szkoły nie udało się uzyskać odpowiedzi na pytanie od minimum 10 respondentów, wynik nie jest prezentowany.\n",
    "    c) W celu zachowania czytelności wykresów, etykiety z wartościami poniżej 6% nie są prezentowane.\n",
    "    d) Niesumowanie się wartości na niektórych wykresach do 100% lub sumowanie się do wartości innej, niż podana w tekście, wynika z zaokrągleń.\n",
    "    e) Ze względu na dużą liczbę raportów (w badaniu wzięli udział absolwenci 1703 szkół), zostały one sporządzone automatycznie.",
    sep = ""
  )
} else {
  cat(
    "    a) Minimalna liczebność grupy respondentów, dla której przedstawiane są poszczególne wyniki w raporcie, wynosi 10 osób. Jeżeli wśród absolwentów szkoły nie udało się uzyskać odpowiedzi na pytanie od minimum 10 respondentów, wynik nie jest prezentowany.\n",
    "    b) Ze względu na dużą liczbę raportów (w badaniu wzięli udział absolwenci 1703 szkół), zostały one sporządzone automatycznie.",
    sep = ""
  )
}
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

3) Absolwenci, których dotyczy raport

    a) Osoby, które w roku 2020/2021 wzięły udział w badaniu jako uczniowie ostatnich klas `r szk$formy[[1]]$typ_szk_dop_mn`, a następnie jako absolwenci w badaniu realizowanym od listopada 2021 roku.
    b) Liczba absolwentów Państwa szkoły, których dotyczy raport: `r szk$l_abs[[1]]`, w tym kobiet: `r szk$l_kobiet[[1]]`.
    c) Zawody i branże, w których kształcili się respondenci w Państwa szkole:

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
szk$zaw_licz[[1]] %>% 
  as_tibble() %>% 
  select(-n) %>% 
  arrange(desc(n_zaw)) %>% 
  kable("latex", booktabs = TRUE, escape = FALSE, longtable = TRUE,
        linesep = "",
        col.names = NULL,
        align = "llc") %>%
  kable_styling(position = wyrownanieTabWykr,
                latex_options = c("hold_position", "repeat_header"),
                repeat_header_text = "(ciąg dalszy tabeli)") %>% 
  add_header_above(c("Branża", "Zawód" = 1, "Liczba\nrespondentów" = 1),
                   align = c("l", "l", "c"))
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

# 2. Sytuacja zawodowa absolwentów w okresie lipiec-październik 2021

## 2.1. Praca zarobkowa

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$praca_zarobkowa[[1]]$n >= progLiczebnosci) {
  cat(
    "Wśród uczestników badania, którzy zakończyli naukę w Państwa szkole, ",
    round(szk$praca_zarobkowa[[1]]$ods_ever * 100),
    "% pracowało zarobkowo przez co najmniej dwa tygodnie w lipcu, sierpniu, wrześniu lub październiku 2021 roku. W przypadku pozostałych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    " co najmniej dwutygodniowy okres pracy w ciągu jednego z tych miesięcy charakteryzował ",
    round(woj$praca_zarobkowa_WT[[1]]$ods_ever * 100),
    "% absolwentów.\n\n",
    "\\textcolor{gray}{Uwzględniono epizody pracy zarobkowej trwające co najmniej dwa tygodnie w danym miesiącu. Do porównań wybrano okres od lipca do października 2021 roku, ponieważ dla tych miesięcy zostały uzyskane informacje o sytuacji zawodowej od wszystkich absolwentów uczestniczących w badaniu (pierwsze ankiety zrealizowano w listopadzie, a respondenci odnosili się do miesięcy poprzedzających miesiąc, w którym wypełniali ankietę).}\n\n",
    "Na poszczególnych wykresach dane dotyczące absolwentów Państwa szkoły są zestawiane z danymi absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ", którzy również zostali objęci badaniem.",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$praca_zarobkowa[[1]]$n >= progLiczebnosci) {
  tab1 = szk$praca_zarobkowa[[1]] %>% 
    as_tibble() %>% 
    select(rozklad = ods_ever) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = woj$praca_zarobkowa_WT[[1]] %>% 
    as_tibble() %>% 
    select(rozklad = ods_ever) %>%  
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
           "Wykres ", wyk_num(),
           ": Odsetek absolwentów, którzy w okresie od lipca do października 2021 roku mieli epizod pracy zarobkowej"),
           width = 80)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$praca_zarobkowa[[1]]$n >= progLiczebnosci) {
  roznice = szk$praca_zarobkowa[[1]][c("ods_07", "ods_08", "ods_09", "ods_10")] %>% 
    unname() %>% 
    n_distinct()
  
  cat(
    "*Wykres przedstawia odpowiedzi ",
    szk$praca_zarobkowa[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$praca_zarobkowa_WT[[1]]$n),
    " absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Proszę spojrzeć na poniższy kalendarz i zaznaczyć miesiące, w których w sumie przez co najmniej dwa tygodnie (bez względu na liczbę godzin w tygodniu): (...) pracował(a) P. we własnym gospodarstwie rolnym lub w gospodarstwie P. rodziny / pracował(a) P. zarobkowo u pracodawcy (na dowolnych zasadach) / pracował(a) P. na własny rachunek, czyli nie u pracodawcy?”. Respondenci, w odniesieniu do każdego miesiąca, wskazywali odpowiedź “Tak” lub “Nie”.*\n\n",
    "Odsetek absolwentów Państwa szkoły wykonujących pracę zarobkową przez co najmniej dwa tygodnie ",
    if (roznice %in% 1) {
      paste0("nie różnił się w zależności od miesiąca.")
    } else {
      paste0("różnił się w zależności od miesiąca i wynosił ",
             round(szk$praca_zarobkowa[[1]]$ods_07 * 100),
             "% w lipcu, ",
             round(szk$praca_zarobkowa[[1]]$ods_08 * 100),
             "% w sierpniu, ",
             round(szk$praca_zarobkowa[[1]]$ods_09 * 100),
             "% we wrześniu i ",
             round(szk$praca_zarobkowa[[1]]$ods_10 * 100),
             "% w październiku.")
    },
    sep = ""
  )
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$praca_zarobkowa[[1]]$n >= progLiczebnosci) {
  tab1 = szk$praca_zarobkowa[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, ods_ever)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Państwa szkoła",
           name = c("2021.07", "2021.08", "2021.09", "2021.10"))
  tab2 = woj$praca_zarobkowa_WT[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, ods_ever)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("2021.07", "2021.08", "2021.09", "2021.10"))
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
           "Wykres ", wyk_num(),
           ": Odsetek absolwentów, którzy w danym miesiącu mieli epizod pracy zarobkowej"),
           width = 80)
  
  wykres = ggplot(tab, aes(x = name, y = value, colour = typ, group = typ)) +
    geom_point(aes(shape = typ, color = typ), size = 2) +
    geom_line(aes(linetype = typ, color = typ), size = 1) +
    ylab(NULL) + 
    xlab("Miesiąc") +
    labs(title = tytul,
         fill = NULL) +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 1),
                       breaks = seq(0, 1,by = 0.2)) +
    theme(legend.title = element_blank(),
          plot.title = element_text(size = 12),
          panel.background = element_rect(fill = "white"),
          panel.grid.major = element_line(color = "lightgray"),
          plot.title.position = "plot") +
    geom_rect(xmin = 0.5, xmax = 4.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    scale_shape_manual(values = c(1, 0)) +
    scale_linetype_manual(values = c(1, 2))
  
  print(wykres)
  
  cat("Dane z wykresu przedstawiono szczegółowo w poniższej tabeli.\n\n")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1)) 
}
```

## 2.2. Bezrobocie rejestrowane

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$bezrobocie[[1]]$n >= progLiczebnosci) {
  cat(
    "W okresie od lipca do października 2021 roku ",
    round(szk$bezrobocie[[1]]$ods_ever * 100),
    "% absolwentów Państwa szkoły uczestniczących w badaniu zarejestrowało się w urzędzie pracy jako osoby bezrobotne. Spośród absolwentów pozostałych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    " co najmniej dwutygodniowy okres zarejestrowanego bezrobocia w lipcu, sierpniu, wrześniu lub październiku 2021 roku odnotowano",
    if (szk$bezrobocie[[1]]$ods_ever == woj$bezrobocie_WT[[1]]$ods_ever) {paste0(" również")},
    " w przypadku ",
    round(woj$bezrobocie_WT[[1]]$ods_ever * 100),
    "%.\n\n\\textcolor{gray}{Uwzględniono epizody zarejestrowanego bezrobocia trwające co najmniej dwa tygodnie w danym miesiącu.}",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$bezrobocie[[1]]$n >= progLiczebnosci) {
  tab1 = szk$bezrobocie[[1]] %>% 
    as_tibble() %>% 
    select(rozklad = ods_ever) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = woj$bezrobocie_WT[[1]] %>% 
    as_tibble() %>% 
    select(rozklad = ods_ever) %>%  
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
    "Wykres ", wyk_num(),
    ": Odsetek absolwentów, którzy w okresie od lipca do października 2021 roku mieli epizod bezrobocia rejestrowanego"),
    width = 80)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$rozklad, 2) < 0.05, -1.3, 0.5)) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$bezrobocie[[1]]$n >= progLiczebnosci) {
  roznice = szk$bezrobocie[[1]][c("ods_07", "ods_08", "ods_09", "ods_10")] %>% 
    unname() %>% 
    n_distinct()
  
  cat(
    "*Wykres przedstawia odpowiedzi ",
    szk$bezrobocie[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$bezrobocie_WT[[1]]$n),
    " absolwenci innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Proszę spojrzeć na poniższy kalendarz i zaznaczyć miesiące, w których w sumie przez co najmniej dwa tygodnie (bez względu na liczbę godzin w tygodniu): (...) był(a) Pan(i) zarejestrowany(a) w urzędzie pracy jako osoba bezrobotna?”. Respondenci, w odniesieniu do każdego miesiąca, wskazywali odpowiedź “Tak” lub “Nie”.*\n\n",
    if (roznice %in% 1) {
      paste0("W ciągu każdego z czterech rozpatrywanych miesięcy osoby zarejestrowane jako bezrobotne stanowiły ",
             round(szk$bezrobocie[[1]]$ods_07 * 100),
             "% absolwentów Państwa szkoły.")
    } else {
      paste0("W lipcu osoby zarejestrowane jako bezrobotne stanowiły ",
             round(szk$bezrobocie[[1]]$ods_07 * 100),
             "% absolwentów Państwa szkoły, w sierpniu ",
             round(szk$bezrobocie[[1]]$ods_08 * 100),
             "%, we wrześniu ",
             round(szk$bezrobocie[[1]]$ods_09 * 100),
             "% i ",
             round(szk$bezrobocie[[1]]$ods_10 * 100),
             "% w październiku.")
    },
    sep = ""
  )
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$bezrobocie[[1]]$n >= progLiczebnosci) {
  tab1 = szk$bezrobocie[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, ods_ever)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Państwa szkoła",
           name = c("2021.07", "2021.08", "2021.09", "2021.10"))
  tab2 = woj$bezrobocie_WT[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, ods_ever)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("2021.07", "2021.08", "2021.09", "2021.10"))
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
           "Wykres ", wyk_num(),
           ": Odsetek absolwentów, którzy w danym miesiącu mieli epizod bezrobocia rejestrowanego"),
           width = 80)
  
  wykres = ggplot(tab, aes(x = name, y = value, colour = typ, group = typ)) +
    geom_point(aes(shape = typ, color = typ), size = 2) +
    geom_line(aes(linetype = typ, color = typ), size = 1) +
    ylab(NULL) + 
    xlab("Miesiąc") +
    labs(title = tytul,
         fill = NULL) +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 1),
                       breaks = seq(0, 1,by = 0.2)) +
    theme(legend.title = element_blank(),
          plot.title = element_text(size = 12),
          panel.background = element_rect(fill = "white"),
          panel.grid.major = element_line(color = "lightgray"),
          plot.title.position = "plot") +
    geom_rect(xmin = 0.5, xmax = 4.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    scale_shape_manual(values = c(1, 0)) +
    scale_linetype_manual(values = c(1, 2))
  
  print(wykres)
  
  cat("Dane z wykresu przedstawiono szczegółowo w poniższej tabeli.\n\n")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1)) 
}
```

## 2.3. Bierność edukacyjna i zawodowa (NEET)

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$neet[[1]]$n >= progLiczebnosci) {
  cat(
    if (szk$neet[[1]]$ods_all %in% 0) {
      paste0("Wśród uczestniczących w badaniu absolwentów Państwa szkoły żaden nie był bierny edukacyjnie i zawodowo przez cały okres od lipca do października 2021 roku.")
    } else {
      paste0("Wśród uczestniczących w badaniu absolwentów Państwa szkoły ",
             round(szk$neet[[1]]$ods_all * 100),
             "% pozostawało biernych przez cały okres od lipca do października 2021 roku.")
    },
    "\n\n\\textcolor{gray}{Bierność edukacyjna i zawodowa jest tutaj rozumiana jako brak w danym miesiącu co najmniej dwutygodniowego epizodu nauki, wykonywania pracy zarobkowej oraz zarejestrowanego bezrobocia. Bierność edukacyjna i zawodowa jest tożsama pojęciu NEET (ang. Neither in Employment nor in Education and Training).}",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$neet[[1]]$n >= progLiczebnosci & szk$neet[[1]]$ods_all > 0) {
  tab1 = szk$neet[[1]] %>% 
    as_tibble() %>% 
    select(rozklad = ods_all) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = woj$neet_WT[[1]] %>% 
    as_tibble() %>% 
    select(rozklad = ods_all) %>%  
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
    "Wykres ", wyk_num(),
    ": Odsetek absolwentów, którzy w okresie od lipca do października 2021 roku pozostawali bierni edukacyjnie i zawodowo"),
    width = 80)
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$rozklad, 2) < 0.05, -1.3, 0.5)) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
  print(wykres)
  
  cat(
    "*Wykres przedstawia odpowiedzi ",
    szk$neet[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$neet_WT[[1]]$n),
    " innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytania “Proszę spojrzeć na poniższy kalendarz i zaznaczyć miesiące, w których w sumie przez co najmniej dwa tygodnie (bez względu na liczbę godzin w tygodniu): studiował(a) P. lub uczył(a) się P. w szkole / pracował(a) P. we własnym gospodarstwie rolnym lub w gospodarstwie P. rodziny / pracował(a) P. zarobkowo u pracodawcy (na dowolnych zasadach) / pracował(a) P. na własny rachunek, czyli nie u pracodawcy / był(a) Pan(i) zarejestrowany(a) w urzędzie pracy jako osoba bezrobotna?”. Respondenci, w odniesieniu do każdego pytania i miesiąca, wskazywali odpowiedź “Tak” lub “Nie”.*\n\n",
    sep = ""
  )
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$neet[[1]]$n >= progLiczebnosci) {
  miesiace = szk$neet[[1]][c("ods_07", "ods_08", "ods_09", "ods_10")] %>%
    as_tibble() %>%
    pivot_longer(everything()) %>%
    mutate(name = c("w lipcu", "w sierpniu", "we wrześniu", "w październiku"))
  
  cat(
    if (nrow(filter(miesiace["value"], value %in% max(value))) %in% 1) {
      cat(
        "Odsetek biernych zawodowo absolwentów Państwa szkoły w ciągu rozpatrywanego okresu był najwyższy ",
        miesiace$name[miesiace$value %in% max(miesiace$value)],
        " - wynosił wówczas ",
        round(max(miesiace$value) * 100),
        "%.\n\n",
        sep = ""
      )
    },
    if (nrow(filter(miesiace["value"], value %in% min(value))) %in% 1) {
      cat(
        "Odsetek biernych zawodowo absolwentów Państwa szkoły w ciągu rozpatrywanego okresu był najniższy ",
        miesiace$name[miesiace$value %in% min(miesiace$value)],
        " - wynosił wówczas ",
        round(min(miesiace$value) * 100),
        "%.\n\n",
        sep = ""
      )
    },
    if (nrow(filter(miesiace["value"], value %in% max(value))) > 1) {
      cat(
        "Odsetek biernych zawodowo absolwentów Państwa szkoły w ciągu rozpatrywanego okresu był najwyższy ",
        paste(miesiace$name[miesiace$value %in% max(miesiace$value)], collapse = ", "),
        " - wynosił wówczas ",
        round(max(miesiace$value) * 100),
        "%.\n\n",
        sep = ""
      )
    },
    if (nrow(filter(miesiace["value"], value %in% min(value))) > 1) {
      cat(
        "Odsetek biernych zawodowo absolwentów Państwa szkoły w ciągu rozpatrywanego okresu był najniższy ",
        paste(miesiace$name[miesiace$value %in% min(miesiace$value)], collapse = ", "),
        " - wynosił wówczas ",
        round(min(miesiace$value) * 100),
        "%.\n\n",
        sep = ""
      )
    },
    if (nrow(filter(miesiace["value"], value %in% min(value))) %in% 4) {
      cat(
        "Odsetek biernych zawodowo absolwentów Państwa szkoły nie różnił się w zależności od miesiąca.\n\n",
        sep = ""
      )
    },
    sep = ""
  )
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$neet[[1]]$n >= progLiczebnosci) {
  tab1 = szk$neet[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, ods_all)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Państwa szkoła",
           name = c("2021.07", "2021.08", "2021.09", "2021.10"))
  tab2 = woj$neet_WT[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, ods_all)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("2021.07", "2021.08", "2021.09", "2021.10"))
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
           "Wykres ", wyk_num(),
           ": Odsetek absolwentów, którzy w danym miesiącu pozostawali bierni edukacyjnie i zawodowo"),
           width = 80)
  
  wykres = ggplot(tab, aes(x = name, y = value, colour = typ, group = typ)) +
    geom_point(aes(shape = typ, color = typ), size = 2) +
    geom_line(aes(linetype = typ, color = typ), size = 1) +
    ylab(NULL) + 
    xlab("Miesiąc") +
    labs(title = tytul,
         fill = NULL) +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 1),
                       breaks = seq(0, 1,by = 0.2)) +
    theme(legend.title = element_blank(),
          plot.title = element_text(size = 12),
          panel.background = element_rect(fill = "white"),
          panel.grid.major = element_line(color = "lightgray"),
          plot.title.position = "plot") +
    geom_rect(xmin = 0.5, xmax = 4.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    scale_shape_manual(values = c(1, 0)) +
    scale_linetype_manual(values = c(1, 2))
  
  print(wykres)
  
  cat("Dane z wykresu przedstawiono szczegółowo w poniższej tabeli.\n\n")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1)) 
}
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

# 3. Sytuacja edukacyjno-zawodowa absolwentów w październiku 2021

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$status_2021_10[[1]]$n >= progLiczebnosci) {
  cat(
    "W październiku 2021 roku ",
    round(szk$status_2021_10[[1]]$nauka_praca * 100),
    "% objętych badaniem absolwentów Państwa szkoły, poświęciło po co najmniej dwa tygodnie zarówno na pracę zarobkową, jak i na naukę w szkole lub na studiach. Z kolei ",
    round(szk$status_2021_10[[1]]$tylko_praca * 100),
    "% pracowało zarobkowo nie kontynuując nauki w tych formach, a ",
    round(szk$status_2021_10[[1]]$tylko_nauka * 100),
    "% uczestniczyło w edukacji, ale nie pracowało. Ani dwutygodniowego okresu pracy zarobkowej, ani takiego okresu nauki, nie miało w październiku ",
    round(szk$status_2021_10[[1]]$brak_nauka_brak_praca * 100),
    "%.\n\n\\textcolor{gray}{Dla absolwentów wszystkich szkół rozpatrywano sytuację w październiku 2021 roku, żeby uwzględnić ewentualne rozpoczynanie nauki na studiach po ukończeniu techników i szkół policealnych.}",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 3.5}
if (szk$status_2021_10[[1]]$n >= progLiczebnosci) {
  tab1 = szk$status_2021_10[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, nie_dotyczy_liczba)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Państwa szkoła") %>% 
    mutate(name = c("Tylko praca",
                    "Tylko nauka",
                    "Nauka i praca",
                    "Brak nauki i brak pracy")) %>% 
    mutate(name = ordered(name, levels = c("Brak nauki i brak pracy",
                                           "Tylko praca",
                                           "Nauka i praca",
                                           "Tylko nauka")))
  
  tab2 = woj$status_2021_10_WT[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, nie_dotyczy_liczba)) %>% 
    pivot_longer(everything()) %>%   
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Pozostałe szkoły\nz województwa") %>% 
    mutate(name = c("Tylko praca",
                    "Tylko nauka",
                    "Nauka i praca",
                    "Brak nauki i brak pracy")) %>% 
    mutate(name = ordered(name, levels = c("Brak nauki i brak pracy",
                                           "Tylko praca",
                                           "Nauka i praca",
                                           "Tylko nauka")))
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
    "Wykres ", wyk_num(),
    ": Sytuacja edukacyjno-zawodowa absolwentów w październiku 2021 roku"),
    width = 80)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_col(width = 0.75, colour = "white") +
    geom_text(aes(label = lab), size = 3, position = position_stack(vjust = 0.5)) +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "bottom",
          legend.justification = "left",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    guides(fill = guide_legend(reverse = TRUE, nrow = 4, byrow = TRUE)) +
    scale_fill_brewer(palette = "RdPu")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$status_2021_10[[1]]$n >= progLiczebnosci) {
  tabela = tab %>% 
    select(-lab) %>% 
    mutate(across(value,
                  ~paste0(round(. * 100), "%"))) %>% 
    pivot_wider(names_from = typ) %>% 
    arrange(desc(name)) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
  
  cat(
    "*Wykres przedstawia rozkład zmiennej utworzonej na podstawie pytań: “Proszę spojrzeć na poniższy kalendarz i zaznaczyć miesiące, w których w sumie przez co najmniej dwa tygodnie (bez względu na liczbę godzin w tygodniu): studiował(a) P. lub uczył(a) się P. w szkole / pracował(a) P. we własnym gospodarstwie rolnym lub w gospodarstwie P. rodziny / pracował(a) P. zarobkowo u pracodawcy (na dowolnych zasadach) / pracował(a) P. na własny rachunek, czyli nie u pracodawcy?”. Respondenci, w odniesieniu do każdego miesiąca, wskazywali odpowiedź “Tak” lub “Nie”. Wykres uwzględnia odpowiedzi dotyczące października, udzielone przez ",
    szk$status_2021_10[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$status_2021_10_WT[[1]]$n),
    " absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ".*\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.\n\n",
    tabela, 
    sep = ""
  )
}
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

# 4. Ścieżki kontynuowania edukacji

<!-- BRANŻOWA SZKOŁA PIERWSZEGO STOPNIA -->

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$TYP_SZK[[1]] %in% 1) {
  if (szk$eduk_kontyn[[1]]$n >= progLiczebnosci) {
    if (!(round(szk$eduk_kontyn[[1]]$any_bs1 * 100) %in% 0)) {
      cat(
        "Pomiędzy lipcem 2021 roku a momentem wypełnienia ankiety (badanie było realizowane w okresie od listopada 2021 do lutego 2022 roku), spośród absolwentów Państwa szkoły naukę w szkole branżowej drugiego stopnia, w liceum dla dorosłych lub na kwalifikacyjnym kursie zawodowym rozpoczęło ",
        round(szk$eduk_kontyn[[1]]$any_bs1 * 100),
        "%.",
        sep = ""
      )
    } else {
      cat("Żaden z absolwentów Państwa szkoły nie kontynuował edukacji w szkole branżowej drugiego stopnia, w liceum dla dorosłych lub na kwalifikacyjnym kursie zawodowym.")
    }
  } else {
    cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
  }
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$TYP_SZK[[1]] %in% 1) {
  if (szk$eduk_kontyn[[1]]$n >= progLiczebnosci) {
    if (!(round(szk$eduk_kontyn[[1]]$any_bs1 * 100) %in% 0)) {
      tab1 = szk$eduk_kontyn[[1]] %>% 
        as_tibble() %>% 
        select(any_bs1) %>% 
        pivot_longer(everything()) %>% 
        mutate(lab = paste0(round(value * 100), "%"),
               typ = "Państwa szkoła")
      
      tab2 = woj$eduk_kontyn_WT[[1]] %>% 
        as_tibble() %>% 
        select(any_bs1) %>% 
        pivot_longer(everything()) %>%   
        mutate(lab = paste0(round(value * 100), "%"),
               typ = "Pozostałe szkoły\nz województwa")
      
      tab = rbind(tab1, tab2)
      
      tytul = wrapper(paste0(
        "Wykres ", wyk_num(),
        ": Odsetek absolwentów, którzy po ukończeniu szkoły branżowej pierwszego stopnia kontynuowali naukę w dowolnej formie"),
        width = 80)
      
      ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value)) +
        geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
        scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
        labs(fill = NULL,
             title = tytul) +
        geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$value, 2) < 0.05, -1.3, 0.5)) +
        ylab(NULL) +
        xlab(NULL) +
        coord_flip() +
        theme(legend.position = "none",
              panel.background = element_rect(fill = "white"),
              axis.ticks.y = element_blank(),
              axis.ticks.x = element_blank(),
              plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
              plot.title = element_text(size = 12)) +
        geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    }
  }
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$TYP_SZK[[1]] %in% 1) {
  if (szk$eduk_kontyn[[1]]$n >= progLiczebnosci) {
    if (!(round(szk$eduk_kontyn[[1]]$any_bs1 * 100) %in% 0)) {
      cat(
        "*Wykres przedstawia odpowiedzi ",
        szk$eduk_kontyn[[1]]$n,
        " absolwentów Państwa szkoły oraz ",
        round(woj$eduk_kontyn_WT[[1]]$n),
        " absolwentów innych ",
        szk$formy[[1]]$typ_szk_dop_mn,
        " z województwa ",
        szk$formy[[1]]$woj_nazwa_dop,
        ". Respondentom zadano pytanie “Czy po zakończeniu nauki w (...) szkole policealnej uczestniczył(a) Pan(i) w rekrutacji: (...) do szkoły policealnej?”. Respondenci wskazywali odpowiedź “Tak i rozpocząłem(a) tam naukę”, “Tak, ale nie rozpocząłem(am) tam nauki” lub “Nie”. Wykres uwzględnia pierwszą z tych odpowiedzi.*\n\n",
        sep = ""
      )
      
      cat(
        "W szkole branżowej drugiego stopnia podjęło dalszą naukę ",
        round(szk$eduk_kontyn[[1]]$bs2 * 100),
        "% absolwentów Państwa szkoły, z którymi zostało przeprowadzone badanie.",
        sep = ""
      )
      
      if (szk$eduk_kontyn[[1]]$bs2 > 0) {
        tab1 = szk$eduk_kontyn[[1]] %>% 
          as_tibble() %>% 
          select(bs2) %>% 
          pivot_longer(everything()) %>% 
          mutate(lab = paste0(round(value * 100), "%"),
                 typ = "Państwa szkoła")
        
        tab2 = woj$eduk_kontyn_WT[[1]] %>% 
          as_tibble() %>% 
          select(bs2) %>% 
          pivot_longer(everything()) %>%   
          mutate(lab = paste0(round(value * 100), "%"),
                 typ = "Pozostałe szkoły\nz województwa")
        
        tab = rbind(tab1, tab2)
        
        tytul = wrapper(paste0(
          "Wykres ", wyk_num(),
          ": Odsetek absolwentów, którzy po ukończeniu szkoły branżowej I stopnia  kontynuowali naukę w branżowej szkole II stopnia"),
          width = 80)
        
        ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value)) +
          geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
          scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
          labs(fill = NULL,
               title = tytul) +
          geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$value, 2) < 0.05, -1.3, 0.5)) +
          ylab(NULL) +
          xlab(NULL) +
          coord_flip() +
          theme(legend.position = "none",
                panel.background = element_rect(fill = "white"),
                axis.ticks.y = element_blank(),
                axis.ticks.x = element_blank(),
                plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
                plot.title = element_text(size = 12)) +
          geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
      } else {
        
      }
      
      
      cat(
        "W liceum dla dorosłych kontynuowało naukę ",
        round(szk$eduk_kontyn[[1]]$lodd * 100),
        "% absolwentów Państwa szkoły objętych badaniem.",
        sep = ""
      )
      
      if (szk$eduk_kontyn[[1]]$lodd > 0) {
        tab1 = szk$eduk_kontyn[[1]] %>% 
          as_tibble() %>% 
          select(lodd) %>% 
          pivot_longer(everything()) %>% 
          mutate(lab = paste0(round(value * 100), "%"),
                 typ = "Państwa szkoła")
        
        tab2 = woj$eduk_kontyn_WT[[1]] %>% 
          as_tibble() %>% 
          select(lodd) %>% 
          pivot_longer(everything()) %>%   
          mutate(lab = paste0(round(value * 100), "%"),
                 typ = "Pozostałe szkoły\nz województwa")
        
        tab = rbind(tab1, tab2)
        
        tytul = wrapper(paste0(
          "Wykres ", wyk_num(),
          ": Odsetek absolwentów, którzy po ukończeniu szkoły branżowej I stopnia  kontynuowali naukę w liceum dla dorosłych"),
          width = 80)
        
        ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value)) +
          geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
          scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
          labs(fill = NULL,
               title = tytul) +
          geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$value, 2) < 0.05, -1.3, 0.5)) +
          ylab(NULL) +
          xlab(NULL) +
          coord_flip() +
          theme(legend.position = "none",
                panel.background = element_rect(fill = "white"),
                axis.ticks.y = element_blank(),
                axis.ticks.x = element_blank(),
                plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
                plot.title = element_text(size = 12)) +
          geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
      }
    }
  }
}
```

<!-- TECHNIKUM -->

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$TYP_SZK[[1]] %in% 2) {
  if (szk$eduk_kontyn[[1]]$n >= progLiczebnosci) {
    if (!(round(szk$eduk_kontyn[[1]]$any_tech * 100) %in% 0)) {
      cat(
        "Pomiędzy lipcem 2021 roku a momentem wypełnienia ankiety (badanie było realizowane w okresie od listopada 2021 do lutego 2022 roku), spośród absolwentów Państwa szkoły naukę w szkole policealnej, na studiach lub na kwalifikacyjnym kursie zawodowym rozpoczęło ",
        round(szk$eduk_kontyn[[1]]$any_tech * 100),
        "%.",
        sep = ""
      )
    } else {
      cat("Żaden z absolwentów Państwa szkoły nie kontynuował edukacji w szkole policealnej, na studiach lub na kwalifikacyjnym kursie zawodowym.")
    }
  } else {
    cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
  }
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$TYP_SZK[[1]] %in% 2) {
  if (szk$eduk_kontyn[[1]]$n >= progLiczebnosci) {
    if (!(round(szk$eduk_kontyn[[1]]$any_tech * 100) %in% 0)) {
      tab1 = szk$eduk_kontyn[[1]] %>% 
        as_tibble() %>% 
        select(any_tech) %>% 
        pivot_longer(everything()) %>% 
        mutate(lab = paste0(round(value * 100), "%"),
               typ = "Państwa szkoła")
      
      tab2 = woj$eduk_kontyn_WT[[1]] %>% 
        as_tibble() %>% 
        select(any_tech) %>% 
        pivot_longer(everything()) %>%   
        mutate(lab = paste0(round(value * 100), "%"),
               typ = "Pozostałe szkoły\nz województwa")
      
      tab = rbind(tab1, tab2)
      
      tytul = wrapper(paste0(
        "Wykres ", wyk_num(),
        ": Odsetek absolwentów, którzy po ukończeniu technikum kontynuowali naukę w dowolnej formie"),
        width = 80)
      
      ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value)) +
        geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
        scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
        labs(fill = NULL,
             title = tytul) +
        geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$value, 2) < 0.05, -1.3, 0.5)) +
        ylab(NULL) +
        xlab(NULL) +
        coord_flip() +
        theme(legend.position = "none",
              panel.background = element_rect(fill = "white"),
              axis.ticks.y = element_blank(),
              axis.ticks.x = element_blank(),
              plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
              plot.title = element_text(size = 12)) +
        geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    }
  }
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$TYP_SZK[[1]] %in% 2) {
  if (szk$eduk_kontyn[[1]]$n >= progLiczebnosci) {
    if (!(round(szk$eduk_kontyn[[1]]$any_tech * 100) %in% 0)) {
      cat(
        "*Wykres przedstawia odpowiedzi ",
        szk$eduk_kontyn[[1]]$n,
        " absolwentów Państwa szkoły oraz ",
        round(woj$eduk_kontyn_WT[[1]]$n),
        " absolwentów innych ",
        szk$formy[[1]]$typ_szk_dop_mn,
        " z województwa ",
        szk$formy[[1]]$woj_nazwa_dop,
        ". Respondentom zadano pytanie “Czy po zakończeniu nauki w technikum próbował(a) się P. dostać: (...) do szkoły policealnej?; na studia na kierunku związanym z zawodem [zawód, w którym kształcił się respondent]; na studia na kierunku niezwiązanym z zawodem [zawód, w którym kształcił się respondent]?; na kwalifikacyjny kurs zawodowy (KKZ), czyli kurs, który kończy sie egzaminem zawodowym?”. Respondenci wskazywali odpowiedź “Tak i rozpocząłem(a) tam naukę”, “Tak, ale nie rozpocząłem(am) tam nauki” lub “Nie”. Wykres uwzględnia pierwszą z tych odpowiedzi.*\n\n",
        sep = ""
      )
      
      cat(
        "Studentami zostało ",
        round(szk$eduk_kontyn[[1]]$stud_ogolem * 100),
        "% absolwentów Państwa szkoły, z którymi przeprowadzono badanie.\r\n\r\n",
        sep = ""
      )
      
      if (szk$eduk_kontyn[[1]]$stud_ogolem > 0) {
        tab1 = szk$eduk_kontyn[[1]] %>% 
          as_tibble() %>% 
          select(stud_ogolem) %>% 
          pivot_longer(everything()) %>% 
          mutate(lab = paste0(round(value * 100), "%"),
                 typ = "Państwa szkoła")
        
        tab2 = woj$eduk_kontyn_WT[[1]] %>% 
          as_tibble() %>% 
          select(stud_ogolem) %>% 
          pivot_longer(everything()) %>%   
          mutate(lab = paste0(round(value * 100), "%"),
                 typ = "Pozostałe szkoły\nz województwa")
        
        tab = rbind(tab1, tab2)
        
        tytul = wrapper(paste0(
          "Wykres ", wyk_num(),
          ": Odsetek absolwentów, którzy po ukończeniu technikum kontynuowali naukę na studiach wyższych"),
          width = 80)
        
        wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value)) +
          geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
          scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
          labs(fill = NULL,
               title = tytul) +
          geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$value, 2) < 0.05, -1.3, 0.5)) +
          ylab(NULL) +
          xlab(NULL) +
          coord_flip() +
          theme(legend.position = "none",
                panel.background = element_rect(fill = "white"),
                axis.ticks.y = element_blank(),
                axis.ticks.x = element_blank(),
                plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
                plot.title = element_text(size = 12)) +
          geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
        print(wykres)
      }
      
        cat(
          "W szkole policealnej podjęło dalszą naukę ",
          round(szk$eduk_kontyn[[1]]$spolic * 100),
          "% absolwentów Państwa szkoły objętych badaniem.\r\n\r\n",
          sep = ""
        )
        
        if (szk$eduk_kontyn[[1]]$spolic > 0) {
        tab1 = szk$eduk_kontyn[[1]] %>% 
          as_tibble() %>% 
          select(spolic) %>% 
          pivot_longer(everything()) %>% 
          mutate(lab = paste0(round(value * 100), "%"),
                 typ = "Państwa szkoła")
        
        tab2 = woj$eduk_kontyn_WT[[1]] %>% 
          as_tibble() %>% 
          select(spolic) %>% 
          pivot_longer(everything()) %>%   
          mutate(lab = paste0(round(value * 100), "%"),
                 typ = "Pozostałe szkoły\nz województwa")
        
        tab = rbind(tab1, tab2)
        
        tytul = wrapper(paste0(
          "Wykres ", wyk_num(),
          ": Odsetek absolwentów, którzy po ukończeniu technikum kontynuowali naukę w szkole policealnej"),
          width = 80)
        
        wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value)) +
          geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
          scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
          labs(fill = NULL,
               title = tytul) +
          geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$value, 2) < 0.05, -1.3, 0.5)) +
          ylab(NULL) +
          xlab(NULL) +
          coord_flip() +
          theme(legend.position = "none",
                panel.background = element_rect(fill = "white"),
                axis.ticks.y = element_blank(),
                axis.ticks.x = element_blank(),
                plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
                plot.title = element_text(size = 12)) +
          geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
        print(wykres)
        }
        
        cat(
          "Kwalifikacyjne kursy zawodowe okazały się formą kontynuowania nauki przez ",
          round(szk$eduk_kontyn[[1]]$kkz * 100),
          "% absolwentów Państwa szkoły, którzy wypełnili ankiety.\r\n\r\n",
          sep = ""
        )
        
        if (szk$eduk_kontyn[[1]]$kkz > 0) {
          tab1 = szk$eduk_kontyn[[1]] %>% 
            as_tibble() %>% 
            select(kkz) %>% 
            pivot_longer(everything()) %>% 
            mutate(lab = paste0(round(value * 100), "%"),
                   typ = "Państwa szkoła")
          
          tab2 = woj$eduk_kontyn_WT[[1]] %>% 
            as_tibble() %>% 
            select(kkz) %>% 
            pivot_longer(everything()) %>%   
            mutate(lab = paste0(round(value * 100), "%"),
                   typ = "Pozostałe szkoły\nz województwa")
          
          tab = rbind(tab1, tab2)
          
          tytul = wrapper(paste0(
            "Wykres ", wyk_num(),
            ": Odsetek absolwentów, którzy po ukończeniu technikum kontynuowali naukę na kwalifikacyjnym kursie zawodowym"),
            width = 80)
          
          wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value)) +
            geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
            scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
            labs(fill = NULL,
                 title = tytul) +
            geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$value, 2) < 0.05, -1.3, 0.5)) +
            ylab(NULL) +
            xlab(NULL) +
            coord_flip() +
            theme(legend.position = "none",
                  panel.background = element_rect(fill = "white"),
                  axis.ticks.y = element_blank(),
                  axis.ticks.x = element_blank(),
                  plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
                  plot.title = element_text(size = 12)) +
            geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
          print(wykres)
        }
    }
  }
}
```

<!-- SZKOŁA POLICEALNA -->

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$TYP_SZK[[1]] %in% 3) {
  if (szk$eduk_kontyn[[1]]$n >= progLiczebnosci) {
    if (!(round(szk$eduk_kontyn[[1]]$kkz * 100) %in% 0)) {
      cat(
        "Pomiędzy lipcem 2021 roku a momentem wypełnienia ankiety (badanie było realizowane w okresie od listopada 2021 do lutego 2022 roku), spośród absolwentów Państwa szkoły naukę na kwalifikacyjnym kursie zawodowym rozpoczęło ",
        round(szk$eduk_kontyn[[1]]$kkz * 100),
        "%.",
        sep = ""
      )
    } else {
      cat("Żaden z absolwentów Państwa szkoły nie kontynuował edukacji na kwalifikacyjnym kursie zawodowym.")
    }
  } else {
    cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
  }
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$TYP_SZK[[1]] %in% 3) {
  if (szk$eduk_kontyn[[1]]$n >= progLiczebnosci) {
    if (!(round(szk$eduk_kontyn[[1]]$kkz * 100) %in% 0)) {
      tab1 = szk$eduk_kontyn[[1]] %>% 
        as_tibble() %>% 
        select(kkz) %>% 
        pivot_longer(everything()) %>% 
        mutate(lab = paste0(round(value * 100), "%"),
               typ = "Państwa szkoła")
      
      tab2 = woj$eduk_kontyn_WT[[1]] %>% 
        as_tibble() %>% 
        select(kkz) %>% 
        pivot_longer(everything()) %>%   
        mutate(lab = paste0(round(value * 100), "%"),
               typ = "Pozostałe szkoły\nz województwa")
      
      tab = rbind(tab1, tab2)
      
      tytul = wrapper(paste0(
        "Wykres ", wyk_num(),
        ": Odsetek absolwentów, którzy po ukończeniu szkoły policealnej rozpoczęli naukę na kwalifikacyjnym kursie zawodowym"),
        width = 80)
      
      ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value)) +
        geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
        scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
        labs(fill = NULL,
             title = tytul) +
        geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$value, 2) < 0.05, -1.3, 0.5)) +
        ylab(NULL) +
        xlab(NULL) +
        coord_flip() +
        theme(legend.position = "none",
              panel.background = element_rect(fill = "white"),
              axis.ticks.y = element_blank(),
              axis.ticks.x = element_blank(),
              plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
              plot.title = element_text(size = 12)) +
        geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    }
  }
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$TYP_SZK[[1]] %in% 3) {
  if (szk$eduk_kontyn[[1]]$n >= progLiczebnosci) {
    if (!(round(szk$eduk_kontyn[[1]]$kkz * 100) %in% 0)) {
      cat(
        "*Wykres przedstawia odpowiedzi ",
        szk$eduk_kontyn[[1]]$n,
        " absolwentów Państwa szkoły oraz ",
        round(woj$eduk_kontyn_WT[[1]]$n),
        " absolwentów innych ",
        szk$formy[[1]]$typ_szk_dop_mn,
        " z województwa ",
        szk$formy[[1]]$woj_nazwa_dop,
        ". Respondentom zadano pytanie “Czy po zakończeniu nauki w (...) szkole policealnej uczestniczył(a) Pan(i) w rekrutacji: (...) do szkoły policealnej?”. Respondenci wskazywali odpowiedź “Tak i rozpocząłem(a) tam naukę”, “Tak, ale nie rozpocząłem(am) tam nauki” lub “Nie”. Wykres uwzględnia pierwszą z tych odpowiedzi.*",
        sep = ""
      )
    }
  }
}
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

# 5. Praca zawodowa

## 5.1. Zgodność pracy z wykształceniem

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zgodnosc_pracy[[1]]$n >= progLiczebnosci) {
  cat(
    "Wykonywanie pracy w zawodzie, którego uczyli się w Państwa szkole, przez co najmniej dwa tygodnie w okresie od lipca 2021 roku do momentu wypełnienia ankiety, zadeklarowało ",
    round(szk$zgodnosc_pracy[[1]]$wyucz * 100),
    "% spośród absolwentów Państwa szkoły, którzy pracowali po zakończeniu w niej nauki.",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$zgodnosc_pracy[[1]]$n >= progLiczebnosci) {
  tab1 = szk$zgodnosc_pracy[[1]] %>% 
    as_tibble() %>% 
    select(rozklad = wyucz) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = woj$zgodnosc_pracy_WT[[1]] %>% 
    as_tibble() %>% 
    select(rozklad = wyucz) %>%  
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
    "Wykres ", wyk_num(),
    ": Odsetek absolwentów, którzy podjęli pracę zarobkową w wyuczonym zawodzie - wśród tych, którzy pracowali"),
    width = 80)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$rozklad, 2) < 0.05, -1.3, 0.5)) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zgodnosc_pracy[[1]]$n >= progLiczebnosci) {
  cat(
    "*Wykres przedstawia odpowiedzi ",
    szk$zgodnosc_pracy[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$zgodnosc_pracy_WT[[1]]$n),
    " absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Czy od czasu ukończenia [typ szkoły, w której uczył się respondent], czyli od lipca 2021 roku w sumie przez co najmniej dwa tygodnie wykonywał(a) Pan(i) pracę zarobkową w: zawodzie [zawód, w którym kształcił się respondent]? (...)”. Respondenci wskazywali odpowiedź “Tak” lub “Nie”.*\n\n",
    "Spośród absolwentów Państwa szkoły, którzy po zakończeniu w niej nauki pracowali ",
    round(szk$zgodnosc_pracy[[1]]$branza * 100),
    "% stwierdziło, że w tym okresie wprawdzie nie pracowali w wyuczonym zawodzie, ale pracowali w branży, do której ten zawód należy.",
    sep = ""
  )
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 2.5}
if (szk$zgodnosc_pracy[[1]]$n >= progLiczebnosci) {
  tab1 = szk$zgodnosc_pracy[[1]] %>% 
    as_tibble() %>% 
    select(rozklad = branza) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = woj$zgodnosc_pracy_WT[[1]] %>% 
    as_tibble() %>% 
    select(rozklad = branza) %>%  
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
    "Wykres ", wyk_num(),
    ": Odsetek absolwentów, którzy nie podjęli pracy w wyuczonym zawodzie, ale podjęli ją w branży do której należy ten zawód - wśród tych, którzy pracowali"),
    width = 80)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$rozklad, 2) < 0.05, -1.3, 0.5)) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zgodnosc_pracy[[1]]$n >= progLiczebnosci) {
  cat(
    "*Wykres przedstawia odpowiedzi ",
    szk$zgodnosc_pracy[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$zgodnosc_pracy_WT[[1]]$n),
    " absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Czy od czasu ukończenia [typ szkoły, w której uczył się respondent] w okresie, czyli od lipca 2021 roku do [miesiąc poprzedzający miesiąc, w którym respondent wypełnia ankietę] 2020 roku w sumie przez co najmniej dwa tygodnie wykonywał(a) Pan(i) pracę zarobkową w: zawodzie [zawód, w którym kształcił się respondent]?; innym zawodzie, ale w branży [branża, w której kształcił się respondent]. Respondenci wskazywali odpowiedź “Tak” lub “Nie”. Na wykresie uwzględniono respondentów, którzy odpowiedzieli przecząco na pytanie dotyczące zawodu ale twierdząco na pytanie dotyczące branży.*",
    sep = ""
  )
}
```

## 5.2. Zadowolenie z pracy

### Ogólne zadowolenie z pracy

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zad_ogolne[[1]]$n >= progLiczebnosci) {
  cat(
    "Spośród absolwentów Państwa szkoły, którzy po zakończeniu nauki w ",
    szk$formy[[1]]$typ_szk_dop_lp,
    " pracowali, ",
    round(szk$zad_ogolne[[1]]$t2b * 100),
    "% wyraziło ogólne zadowolenie ze swojej pierwszej pracy po zakończeniu nauki w szkole. Niezadowolonych było ",
    if (round(szk$zad_ogolne[[1]]$t2b * 100) == round(szk$zad_ogolne[[1]]$b2b * 100)) {
      paste0("tyle samo absolwentów.")
    } else if (round(szk$zad_ogolne[[1]]$t2b * 100) > round(szk$zad_ogolne[[1]]$b2b * 100)) {
      paste0("mniej, bo ", round(szk$zad_ogolne[[1]]$b2b * 100), "% absolwentów.")
    } else if (round(szk$zad_ogolne[[1]]$t2b * 100) < round(szk$zad_ogolne[[1]]$b2b * 100)) {
      paste0("więcej, bo: ", round(szk$zad_ogolne[[1]]$b2b * 100), "% absolwentów.")
    },
    " Pozostali wybrali odpowiedź pośrednią (",
    round(szk$zad_ogolne[[1]]$ani_ani * 100),
    "%) lub nie byli w stanie ocenić, na ile są zadowoleni (",
    round(szk$zad_ogolne[[1]]$trud_pow * 100),
    "%).",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 4.5}
if (szk$zad_ogolne[[1]]$n >= progLiczebnosci) {
  tab1 = szk$zad_ogolne[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, t2b, b2b)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Państwa szkoła") %>% 
    mutate(name = c("Bardzo dobrze",
                    "Dobrze",
                    "Przeciętnie",
                    "Źle",
                    "Bardzo źle",
                    "Trudno mi ocenić pracę pod tym względem")) %>% 
    mutate(name = ordered(name, levels = c("Trudno mi ocenić pracę pod tym względem",
                                           "Bardzo źle",
                                           "Źle",
                                           "Przeciętnie",
                                           "Dobrze",
                                           "Bardzo dobrze")))
  
  tab2 = woj$zad_ogolne_WT[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, t2b, b2b)) %>% 
    pivot_longer(everything()) %>%   
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Pozostałe szkoły\nz województwa") %>% 
    mutate(name = c("Bardzo dobrze",
                    "Dobrze",
                    "Przeciętnie",
                    "Źle",
                    "Bardzo źle",
                    "Trudno mi ocenić pracę pod tym względem")) %>% 
    mutate(name = ordered(name, levels = c("Trudno mi ocenić pracę pod tym względem",
                                           "Bardzo źle",
                                           "Źle",
                                           "Przeciętnie",
                                           "Dobrze",
                                           "Bardzo dobrze")))
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
    "Wykres ", wyk_num(),
    ": Opinie absolwentów dotyczące ogólnego poziomu zadowolenia z podjętej pracy zarobkowej"),
    width = 80)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_col(width = 0.75, colour = "white", position = "stack") +
    geom_text(aes(label = lab), size = 3, position = position_stack(vjust = 0.5)) +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "bottom",
          legend.justification = "left",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    guides(fill = guide_legend(reverse = TRUE, nrow = 6, byrow = TRUE)) +
    scale_fill_brewer(palette = "RdPu")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zad_ogolne[[1]]$n >= progLiczebnosci) {
  cat(
    "*Wykres przedstawia odpowiedzi ",
    szk$zad_ogolne[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$zad_ogolne_WT[[1]]$n),
    " absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Proszę pomyśleć o pierwszej pracy jaką przez co najmniej dwa tygodnie wykonywał(a) Pan(i) po zakończeniu nauki w [typ szkoły w której uczył się respondent]. Jak Pan(i) ocenia tę pracę… ogólnie, biorąc wszystko pod uwagę”. Respondenci wskazywali odpowiedź:  “Bardzo dobrze” , “Dobrze”, “Przeciętnie”, “Źle”, “Bardzo źle”, “Trudno mi ocenić pracę pod tym względem”.*",
    sep = ""
  )
}
```

`r ifelse(szk$zad_ogolne[[1]]$n >= progLiczebnosci, ifelse(typDokumentu %in% "pdf", "\\newpage", ""), "")`

### Możliwości doskonalenia umiejętności

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zad_rozwoj[[1]]$n >= progLiczebnosci) {
  cat(
    "Z możliwości doskonalenia umiejętności, jakie dawała pierwsza  praca po zakończeniu nauki w szkole, zadowolonych było ",
    round(szk$zad_rozwoj[[1]]$t2b * 100),
    "% spośród pracujących zarobkowo absolwentów Państwa szkoły. Z kolei niezadowolonych pod tym względem było ",
    if (round(szk$zad_rozwoj[[1]]$t2b * 100) == round(szk$zad_rozwoj[[1]]$b2b * 100)) {
      paste0("tyle samo.")
    } else if (round(szk$zad_rozwoj[[1]]$t2b * 100) > round(szk$zad_rozwoj[[1]]$b2b * 100)) {
      paste0("mniej: ", round(szk$zad_rozwoj[[1]]$b2b * 100), "%.")
    } else if (round(szk$zad_rozwoj[[1]]$t2b * 100) < round(szk$zad_rozwoj[[1]]$b2b * 100)) {
      paste0("więcej: ", round(szk$zad_rozwoj[[1]]$b2b * 100), "%.")
    },
    " Pozostali wybrali odpowiedź pośrednią (",
    round(szk$zad_rozwoj[[1]]$ani_ani * 100),
    "%) lub nie byli w stanie ocenić, na ile są zadowoleni (",
    round(szk$zad_rozwoj[[1]]$trud_pow * 100),
    "%).",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 4.5}
if (szk$zad_rozwoj[[1]]$n >= progLiczebnosci) {
  tab1 = szk$zad_rozwoj[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, t2b, b2b)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Państwa szkoła") %>% 
    mutate(name = c("Bardzo dobrze",
                    "Dobrze",
                    "Przeciętnie",
                    "Źle",
                    "Bardzo źle",
                    "Trudno mi ocenić pracę pod tym względem")) %>% 
    mutate(name = ordered(name, levels = c("Trudno mi ocenić pracę pod tym względem",
                                           "Bardzo źle",
                                           "Źle",
                                           "Przeciętnie",
                                           "Dobrze",
                                           "Bardzo dobrze")))
  
  tab2 = woj$zad_rozwoj_WT[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, t2b, b2b)) %>% 
    pivot_longer(everything()) %>%   
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Pozostałe szkoły\nz województwa") %>% 
    mutate(name = c("Bardzo dobrze",
                    "Dobrze",
                    "Przeciętnie",
                    "Źle",
                    "Bardzo źle",
                    "Trudno mi ocenić pracę pod tym względem")) %>% 
    mutate(name = ordered(name, levels = c("Trudno mi ocenić pracę pod tym względem",
                                           "Bardzo źle",
                                           "Źle",
                                           "Przeciętnie",
                                           "Dobrze",
                                           "Bardzo dobrze")))
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
    "Wykres ", wyk_num(),
    ": Opinie absolwentów dotyczące poziomu zadowolenia z możliwości rozwoju zawodowego w podjętej pracy zarobkowej"),
    width = 80)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_col(width = 0.75, colour = "white", position = "stack") +
    geom_text(aes(label = lab), size = 3, position = position_stack(vjust = 0.5)) +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "bottom",
          legend.justification = "left",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    guides(fill = guide_legend(reverse = TRUE, nrow = 6, byrow = TRUE)) +
    scale_fill_brewer(palette = "RdPu")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zad_rozwoj[[1]]$n >= progLiczebnosci) {
  cat(
    "*Wykres przedstawia odpowiedzi ",
    szk$zad_rozwoj[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$zad_rozwoj_WT[[1]]$n),
    " absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Proszę pomyśleć o pierwszej pracy jaką przez co najmniej dwa tygodnie wykonywał(a) Pan(i) po zakończeniu nauki w [typ szkoły w której uczył się respondent]. Jak Pan(i) ocenia tę pracę … pod względem możliwości doskonalenia umiejętności.”. Respondenci wskazywali odpowiedź:  “Bardzo dobrze” , “Dobrze”, “Przeciętnie, “Źle”, “Bardzo źle”, “Trudno mi ocenić pracę pod tym względem”.*",
    sep = ""
  )
}
```

`r ifelse(szk$zad_rozwoj[[1]]$n >= progLiczebnosci, ifelse(typDokumentu %in% "pdf", "\\newpage", ""), "")`

### Możliwości łączenia pracy z życiem poza pracą

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zad_zycie[[1]]$n >= progLiczebnosci) {
  cat(
    "Pod względem możliwości godzenia wykonywanej pracy z “życiem poza pracą” usatysfakcjonowanych było ",
    round(szk$zad_zycie[[1]]$t2b * 100),
    "% spośród absolwentów Państwa szkoły, którzy pracowali zarobkowo. Przeciwną opinię wyraziło ",
    if (round(szk$zad_zycie[[1]]$t2b * 100) == round(szk$zad_zycie[[1]]$b2b * 100)) {
      paste0("tyle samo absolwentów.")
    } else if (round(szk$zad_zycie[[1]]$t2b * 100) > round(szk$zad_zycie[[1]]$b2b * 100)) {
      paste0("mniej absolwentów.: ", round(szk$zad_zycie[[1]]$b2b * 100), "%.")
    } else if (round(szk$zad_zycie[[1]]$t2b * 100) < round(szk$zad_zycie[[1]]$b2b * 100)) {
      paste0("więcej absolwentów, bo ", round(szk$zad_zycie[[1]]$b2b * 100), "%.")
    },
    " Pozostali wybrali odpowiedź pośrednią (",
    round(szk$zad_zycie[[1]]$ani_ani * 100),
    "%) lub nie byli w stanie ocenić, na ile są zadowoleni (",
    round(szk$zad_zycie[[1]]$trud_pow * 100),
    "%).",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 4.5}
if (szk$zad_zycie[[1]]$n >= progLiczebnosci) {
  tab1 = szk$zad_zycie[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, t2b, b2b)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Państwa szkoła") %>% 
    mutate(name = c("Bardzo dobrze",
                    "Dobrze",
                    "Przeciętnie",
                    "Źle",
                    "Bardzo źle",
                    "Trudno mi ocenić pracę pod tym względem")) %>% 
    mutate(name = ordered(name, levels = c("Trudno mi ocenić pracę pod tym względem",
                                           "Bardzo źle",
                                           "Źle",
                                           "Przeciętnie",
                                           "Dobrze",
                                           "Bardzo dobrze")))
  
  tab2 = woj$zad_zycie_WT[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, t2b, b2b)) %>% 
    pivot_longer(everything()) %>%   
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Pozostałe szkoły\nz województwa") %>% 
    mutate(name = c("Bardzo dobrze",
                    "Dobrze",
                    "Przeciętnie",
                    "Źle",
                    "Bardzo źle",
                    "Trudno mi ocenić pracę pod tym względem")) %>% 
    mutate(name = ordered(name, levels = c("Trudno mi ocenić pracę pod tym względem",
                                           "Bardzo źle",
                                           "Źle",
                                           "Przeciętnie",
                                           "Dobrze",
                                           "Bardzo dobrze")))
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
    "Wykres ", wyk_num(),
    ": Opinie absolwentów dotyczące poziomu zadowolenia z możliwości godzenia pracy zarobkowej z życiem poza pracą"),
    width = 80)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_col(width = 0.75, colour = "white", position = "stack") +
    geom_text(aes(label = lab), size = 3, position = position_stack(vjust = 0.5)) +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "bottom",
          legend.justification = "left",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    guides(fill = guide_legend(reverse = TRUE, nrow = 6, byrow = TRUE)) +
    scale_fill_brewer(palette = "RdPu")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zad_zycie[[1]]$n >= progLiczebnosci) {
  cat(
    "*Wykres przedstawia odpowiedzi ",
    szk$zad_zycie[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$zad_zycie_WT[[1]]$n),
    " absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Proszę pomyśleć o pierwszej pracy jaką przez co najmniej dwa tygodnie wykonywał(a) Pan(i) po zakończeniu nauki w [typ szkoły w której uczył się respondent]. Jak Pan(i) ocenia tę pracę … pod względem możliwości łączenia pracy z życiem poza pracą”. Respondenci wskazywali odpowiedź: “Bardzo dobrze”, “Dobrze”, “Przeciętnie”, “Źle”, “Bardzo źle”, “Trudno mi ocenić pracę pod tym względem”.*",
    sep = ""
  )
}
```

`r ifelse(szk$zad_zycie[[1]]$n >= progLiczebnosci, ifelse(typDokumentu %in% "pdf", "\\newpage", ""), "")`

### Satysfakcja z poziom zarobków

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zad_zarobki[[1]]$n >= progLiczebnosci) {
  cat(
    "Zarobkami usatysfakcjonowanych było ",
    round(szk$zad_zarobki[[1]]$t2b * 100),
    "% spośród pracujących absolwentów Państwa szkoły. Niezadowolenie z wysokości zarobków wyraziło ",
    if (round(szk$zad_zarobki[[1]]$t2b * 100) == round(szk$zad_zarobki[[1]]$b2b * 100)) {
      paste0("tyle samo absolwentów.")
    } else if (round(szk$zad_zarobki[[1]]$t2b * 100) > round(szk$zad_zarobki[[1]]$b2b * 100)) {
      paste0("mniej absolwentów, bo ", round(szk$zad_zarobki[[1]]$b2b * 100), "%.")
    } else if (round(szk$zad_zarobki[[1]]$t2b * 100) < round(szk$zad_zarobki[[1]]$b2b * 100)) {
      paste0("więcej absolwentów, bo ", round(szk$zad_zarobki[[1]]$b2b * 100), "%.")
    },
    " Pozostali wybrali odpowiedź pośrednią (",
    round(szk$zad_zarobki[[1]]$ani_ani * 100),
    "%) lub nie byli w stanie ocenić, na ile są zadowoleni (",
    round(szk$zad_zarobki[[1]]$trud_pow * 100),
    "%).",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 4.5}
if (szk$zad_zarobki[[1]]$n >= progLiczebnosci) {
  tab1 = szk$zad_zarobki[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, t2b, b2b)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Państwa szkoła") %>% 
    mutate(name = c("Bardzo dobrze",
                    "Dobrze",
                    "Przeciętnie",
                    "Źle",
                    "Bardzo źle",
                    "Trudno mi ocenić pracę pod tym względem")) %>% 
    mutate(name = ordered(name, levels = c("Trudno mi ocenić pracę pod tym względem",
                                           "Bardzo źle",
                                           "Źle",
                                           "Przeciętnie",
                                           "Dobrze",
                                           "Bardzo dobrze")))
  
  tab2 = woj$zad_zarobki_WT[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, t2b, b2b)) %>% 
    pivot_longer(everything()) %>%   
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Pozostałe szkoły\nz województwa") %>% 
    mutate(name = c("Bardzo dobrze",
                    "Dobrze",
                    "Przeciętnie",
                    "Źle",
                    "Bardzo źle",
                    "Trudno mi ocenić pracę pod tym względem")) %>% 
    mutate(name = ordered(name, levels = c("Trudno mi ocenić pracę pod tym względem",
                                           "Bardzo źle",
                                           "Źle",
                                           "Przeciętnie",
                                           "Dobrze",
                                           "Bardzo dobrze")))
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
    "Wykres ", wyk_num(),
    ": Opinie absolwentów dotyczące poziomu satysfakcji z uzyskiwanych zarobków"),
    width = 80)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_col(width = 0.75, colour = "white", position = "stack") +
    geom_text(aes(label = lab), size = 3, position = position_stack(vjust = 0.5)) +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "bottom",
          legend.justification = "left",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    guides(fill = guide_legend(reverse = TRUE, nrow = 6, byrow = TRUE)) +
    scale_fill_brewer(palette = "RdPu")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zad_zarobki[[1]]$n >= progLiczebnosci) {
  cat(
    "*Wykres przedstawia odpowiedzi ",
    szk$zad_zarobki[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$zad_zarobki_WT[[1]]$n),
    " absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Proszę pomyśleć o pierwszej pracy jaką przez co najmniej dwa tygodnie wykonywał(a) Pan(i) po zakończeniu nauki w [typ szkoły w której uczył się respondent]. Jak Pan(i) ocenia tę pracę … pod względem zarobków”. Respondenci wskazywali odpowiedź:  “Bardzo dobrze” , “Dobrze”, “Przeciętnie”, “Źle”, “Bardzo źle”, “Trudno mi ocenić pracę pod tym względem”.*",
    sep = ""
  )
}
```

`r ifelse(szk$zad_zarobki[[1]]$n >= progLiczebnosci, ifelse(typDokumentu %in% "pdf", "\\newpage", ""), "")`

### Pewność utrzymania pracy

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zad_utrzym[[1]]$n >= progLiczebnosci) {
  cat(
    "Pewność utrzymania pracy pozytywnie oceniło ",
    round(szk$zad_utrzym[[1]]$t2b * 100),
    "% spośród pracujących absolwentów Państwa szkoły. Niezadowolenie z pierwszej pracy pod względem stopnia pewności, że uda się ją utrzymać, wyraziło ",
    if (round(szk$zad_utrzym[[1]]$t2b * 100) == round(szk$zad_utrzym[[1]]$b2b * 100)) {
      paste0("tyle samo absolwentów.")
    } else if (round(szk$zad_utrzym[[1]]$t2b * 100) > round(szk$zad_utrzym[[1]]$b2b * 100)) {
      paste0("mniej absolwentów, bo ", round(szk$zad_utrzym[[1]]$b2b * 100), "%.")
    } else if (round(szk$zad_utrzym[[1]]$t2b * 100) < round(szk$zad_utrzym[[1]]$b2b * 100)) {
      paste0("więcej absolwentów, bo ", round(szk$zad_utrzym[[1]]$b2b * 100), "%.")
    },
    " Pozostali wybrali odpowiedź pośrednią (",
    round(szk$zad_utrzym[[1]]$ani_ani * 100),
    "%) lub nie byli w stanie ocenić, na ile są zadowoleni (",
    round(szk$zad_utrzym[[1]]$trud_pow * 100),
    "%).",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr, fig.height = 4.5}
if (szk$zad_utrzym[[1]]$n >= progLiczebnosci) {
  tab1 = szk$zad_utrzym[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, t2b, b2b)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Państwa szkoła") %>% 
    mutate(name = c("Bardzo dobrze",
                    "Dobrze",
                    "Przeciętnie",
                    "Źle",
                    "Bardzo źle",
                    "Trudno mi ocenić pracę pod tym względem")) %>% 
    mutate(name = ordered(name, levels = c("Trudno mi ocenić pracę pod tym względem",
                                           "Bardzo źle",
                                           "Źle",
                                           "Przeciętnie",
                                           "Dobrze",
                                           "Bardzo dobrze")))
  
  tab2 = woj$zad_utrzym_WT[[1]] %>% 
    as_tibble() %>% 
    select(-c(n, t2b, b2b)) %>% 
    pivot_longer(everything()) %>%   
    mutate(lab = ifelse(value >= 0.06, paste0(round(value * 100), "%"), ""),
           typ = "Pozostałe szkoły\nz województwa") %>% 
    mutate(name = c("Bardzo dobrze",
                    "Dobrze",
                    "Przeciętnie",
                    "Źle",
                    "Bardzo źle",
                    "Trudno mi ocenić pracę pod tym względem")) %>% 
    mutate(name = ordered(name, levels = c("Trudno mi ocenić pracę pod tym względem",
                                           "Bardzo źle",
                                           "Źle",
                                           "Przeciętnie",
                                           "Dobrze",
                                           "Bardzo dobrze")))
  
  tab = rbind(tab1, tab2)
  
  tytul = wrapper(paste0(
    "Wykres ", wyk_num(),
    ": Opinie absolwentów dotyczące poziomu zadowolenia ze stabilności pracy zarobkowej"),
    width = 80)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_col(width = 0.75, colour = "white", position = "stack") +
    geom_text(aes(label = lab), size = 3, position = position_stack(vjust = 0.5)) +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = tytul) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "bottom",
          legend.justification = "left",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    guides(fill = guide_legend(reverse = TRUE, nrow = 6, byrow = TRUE)) +
    scale_fill_brewer(palette = "RdPu")
}
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.align=wyrownanieTabWykr}
if (szk$zad_utrzym[[1]]$n >= progLiczebnosci) {
  cat(
    "*Wykres przedstawia odpowiedzi ",
    szk$zad_utrzym[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(woj$zad_utrzym_WT[[1]]$n),
    " absolwentów innych ",
    szk$formy[[1]]$typ_szk_dop_mn,
    " z województwa ",
    szk$formy[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Proszę pomyśleć o pierwszej pracy jaką przez co najmniej dwa tygodnie wykonywał(a) Pan(i) po zakończeniu nauki w [typ szkoły w której uczył się respondent]. Jak Pan(i) ocenia tę pracę … pod względem pewności zatrudnienia / utrzymania pracy”. Respondenci wskazywali odpowiedź:  “Bardzo dobrze” , “Dobrze”, “Przeciętnie”, “Źle”, “Bardzo źle”, “Trudno mi ocenić pracę pod tym względem”.*",
    sep = ""
  )
}
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")` 

`r ifelse(typDokumentu %in% "pdf", "---", "")`

Więcej informacji o wynikach badania znajdą Państwo na stronie:

<https://losyabsolwentow.ibe.edu.pl/>
